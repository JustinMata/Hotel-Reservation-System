package hotel;

import java.awt.BorderLayout;
import java.awt.Container;
import java.awt.FlowLayout;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Iterator;
import java.util.Scanner;

import javax.swing.*;

public class ReservationFrame {
	final int FIELD_WIDTH = 20;
	public ReservationFrame()
	{
	}

	public void makeReservationFrame(){
		
		JFrame frame = new JFrame();
		final JLabel text = new JLabel("What would you like to do? ");
		
		//add "Make a Reservation" and "makeReservationButton" buttons
		JButton makeReservationButton = new JButton("Make a Reservation");
		JButton ViewCancelButton = new JButton("View/Cancel a Reservation");
		
		
		//add MouseListener to buttons
		makeReservationButton.addMouseListener(
				new MouseListener(){

					@Override
					public void mouseClicked(MouseEvent e) {
						// TODO Auto-generated method stub
						makeReservation();
						frame.dispose();
					}

					@Override
					public void mouseEntered(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}

					@Override
					public void mouseExited(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}

					@Override
					public void mousePressed(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}

					@Override
					public void mouseReleased(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}
					
				});
		
		ViewCancelButton.addMouseListener(
				new MouseListener(){

					@Override
					public void mouseClicked(MouseEvent e) {
						// TODO Auto-generated method stub
						
						frame.dispose();
					}

					@Override
					public void mouseEntered(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}

					@Override
					public void mouseExited(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}

					@Override
					public void mousePressed(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}

					@Override
					public void mouseReleased(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}
					
				});
		
		frame.setLayout(new FlowLayout());
		frame.add(text);
		frame.add(makeReservationButton);
		frame.add(ViewCancelButton);
		
		frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		frame.pack();
		frame.setVisible(true);
		
		
	}
	public void makeReservation()
	{
		JFrame frame = new JFrame();
		final JLabel roomTypeText = new JLabel("Room type: ");
		
		//add "Sign up" and "Sign in" buttons
		JButton luxuriousButton = new JButton("$300");
		JButton economicButton = new JButton("$100");
		JButton showAllButton = new JButton("Show Me Available Rooms");
		
		//create Check in and Check out Date options
		JPanel cont1 = new JPanel();
		JPanel cont2 = new JPanel();
		final JLabel checkInText = new JLabel("Check in");
		final JLabel checkOutText = new JLabel("Check out");
		//make this open GUI calendar
		JTextField checkInDate = new JTextField(FIELD_WIDTH);
		JTextField checkOutDate = new JTextField(FIELD_WIDTH);
		
		
		
		
		//add MouseListeners to buttons
		luxuriousButton.addMouseListener(
				new MouseListener(){

					@Override
					public void mouseClicked(MouseEvent e) {
						// TODO Auto-generated method stub
						
						frame.dispose();
					}

					@Override
					public void mouseEntered(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}

					@Override
					public void mouseExited(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}

					@Override
					public void mousePressed(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}

					@Override
					public void mouseReleased(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}
					
				});
		economicButton.addMouseListener(
				new MouseListener(){

					@Override
					public void mouseClicked(MouseEvent e) {
						// TODO Auto-generated method stub
						
						frame.dispose();
					}

					@Override
					public void mouseEntered(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}

					@Override
					public void mouseExited(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}

					@Override
					public void mousePressed(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}

					@Override
					public void mouseReleased(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}
					
				});
		showAllButton.addMouseListener(
				new MouseListener(){

					@Override
					public void mouseClicked(MouseEvent e) {
						// TODO Auto-generated method stub
						
						frame.dispose();
					}

					@Override
					public void mouseEntered(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}

					@Override
					public void mouseExited(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}

					@Override
					public void mousePressed(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}

					@Override
					public void mouseReleased(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}
					
				});
		
		
		
		frame.setLayout(new BorderLayout());
		
		//frame.getContentPane().add(cont1);
		frame.add(cont1, BorderLayout.PAGE_START);
		frame.setSize(400, 300);
		
		//TODO need to add in the selectable date stuffs/////////////
		cont1.add(checkInText);
		cont1.add(checkInDate);
		cont1.add(checkOutText);
		cont1.add(checkOutDate);
		
		
		cont2.add(roomTypeText);
		cont2.add(luxuriousButton);
		cont2.add(economicButton);
		cont2.add(showAllButton);
		frame.add(cont2, BorderLayout.PAGE_END);
		
		frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		frame.pack();
		frame.setVisible(true);
	}
	
//part of Stina and Mata's code from Room
	public boolean isAvailable(Date start, Date end) {
		boolean roomAvail = false;
		
				File userList = new File("reservations.txt");
			    try {
			    
				Scanner in = new Scanner(new FileReader(userList));
				while(in.hasNextLine()){
				
					String currentLine = in.nextLine();
					String[] split = currentLine.split(",");
					

					Date startDate = start;
					Date endDate = end;
					
					DateFormat dateFormat = new SimpleDateFormat("MM/dd/yyyy");
					String startDateText = dateFormat.format(startDate).toString();
					String endDateText =  dateFormat.format(endDate).toString();
					
			        User tempUser = new Guest(split[0],split[1],split[2]);
			        roomAvail = tempUser.verification((answerTextList.get(0).getText()), (answerTextList.get(1).getText()));
			        
			        if (roomAvail==true)
			        {
			        	ReservationFrame resFrame = new ReservationFrame();
			        	resFrame.makeReservationFrame();
			        	frame.dispose();
			        	break;
			        }
			        
					
				}
	
			        
			    } catch (IOException e1) {e1.printStackTrace();}
		
		
		
		Iterator<Reservation> it = reservationList.getReservationList();
		
		while (it.hasNext()) {
			Reservation rv = it.next();
			Date startDate = rv.getStartDate();
			Date endDate = rv.getEndDate();
			
			if(((startDate.after(start) || startDate.equals(start))
	          && (startDate.before(end)) || startDate.equals(end))
	          ||  ((endDate.after(start) || endDate.equals(start)) 
              && (endDate.before(end) || endDate.equals(end))))
					return false;
		}
		return true;
	}
}
